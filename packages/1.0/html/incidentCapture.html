<card id="incidentCapture" fill="true">
  <face id="incidentCaptureStep1" settings="default:true" controller="_incidentCapture.Ctrl">
    <ctl>Adding an Incident record - {{currStep}}/4</ctl>
    <ctr></ctr>
    <content id="frontContent">
      <div id="step1" ng-if="currStep == 1" align="center">
      <table class="cardFormContainer" cellspacing='0' cellpadding='0'>
          <tr>
             <td class="cardFormElementTitle">Incident description</td>
          </tr>
           <tr>
            <td colspan="2" class="cardFormElementContent">
              <div  class="cardInlay">
               <ul>
		        <li class="cardListElement">
		         <table>
		          <tr>
		            <td align="right">
		              <input type="Text" ng-model="model.description" />
		            </td>
		          </tr>
		         </table>
		        </li>
		       </ul>
              </div>
             </td>
           </tr>
      </table><br/>
      <table class="cardFormContainer" cellspacing='0' cellpadding='0'>
          <tr>
             <td class="cardFormElementTitle">Incident status</td>
          </tr>
           <tr>
            <td colspan="2" class="cardFormElementContent">
              <div  class="cardInlay">
               <ul>
		        <li class="cardListElement">
		         <table>
		          <tr>
		            <td align="right">
                  <select ng-model="model.incidentStatusSelect" ng-options="status.SourceList for status in model.incidentStatus" ></select>
		            </td>
		          </tr>
		         </table>
		        </li>
		       </ul>
              </div>
             </td>
           </tr>
      </table><br/>
      <table class="cardFormContainer" cellspacing='0' cellpadding='0'>
          <tr>
             <td class="cardFormElementTitle">Date incident occurred</td>
          </tr>
           <tr>
            <td colspan="2" class="cardFormElementContent">
              <div  class="cardInlay">
               <ul>
		        <li class="cardListElement">
		         <table>
		          <tr>
		            <td align="right">
		              <input type="date" ng-model="model.date"  />
		            </td>
		          </tr>
		         </table>
		        </li>
		       </ul>
              </div>
             </td>
           </tr>
      </table><br/>
      <table class="cardFormContainer" cellspacing='0' cellpadding='0'>
          <tr>
             <td class="cardFormElementTitle">Time incident occurred</td>
          </tr>
           <tr>
            <td colspan="2" class="cardFormElementContent">
              <div  class="cardInlay">
               <ul>
            <li class="cardListElement">
             <table>
              <tr>
                <td align="right">
                  <input type="time" ng-model="model.time" />
                </td>
              </tr>
             </table>
            </li>
           </ul>
              </div>
             </td>
           </tr>
      </table><br/>
    </div>
    <div id="step2" ng-if="currStep == 2" align="center">
      <div id="popDiv" class="ontop" ng-init="_click=false;" align="left">
        <div id="popup" style="border: 1px solid #bbb">
          <div style="height: 20%; border-bottom: 1px solid #bbb;color:#000 ;margin: 0; padding: 0;">
            Location
          </div>
        <div id="level-scroll" style="height: 100px ;padding-top: 5px; padding-bottom: 5px; overflow:auto">
          <div id="expList" class="gui-extra">
            <div ng-include="'partialMenu'" ng-init="sites = model.sites"></div>
          </div>
        </div>
         <div style=" position: absolute;bottom: 0; height:20%;width:100%;padding-top: 2px; padding-bottom: 2px; background: rgba(240, 240, 240, 1) !important" >
           <button style="border: 1px solid #000;border-radius: 1px;width: 100%; height: 90%; float: right; background: rgb(200,200,200);" type="button" onClick="_incidentCapture.hide('popDiv')" >Cancel</button>
         </div>
      </div>
    </div>
    <script type="text/ng-template" id="partialMenu">
            <ul>
              <li ng-repeat="site in sites" siteId={{site.SiteID}}> {{site.Site}} <x ng-if="site.children.length > 0">&#xf067;</x>
                  <div ng-if="site.children.length > 0" ng-init="sites = site.children" ng-include="'partialMenu'"></div>
              </li>
            </ul>
          </script>


      <table class="cardFormContainer" cellspacing='0' cellpadding='0'>
          <tr>
             <td class="cardFormElementTitle">Person Reporting</td>
          </tr>
           <tr>
            <td colspan="2" class="cardFormElementContent">
              <div  class="cardInlay">
               <ul>
            <li class="cardListElement">
             <table>
              <tr>
                <td align="right">
                  <input type="Text" ng-model="model.person" />
                </td>
              </tr>
             </table>
            </li>
           </ul>
              </div>
             </td>
           </tr>
      </table><br/>
      <table class="cardFormContainer" cellspacing='0' cellpadding='0'>
          <tr>
             <td class="cardFormElementTitle">Incident reported to</td>
          </tr>
           <tr>
            <td colspan="2" class="cardFormElementContent">
              <div  class="cardInlay">
               <ul>
            <li class="cardListElement">
             <table>
              <tr>
                <td align="right">
                 <select ng-model="model.usersSelect" ng-options="user.name for user in model.users" ></select>
                </td>
              </tr>
             </table>
            </li>
           </ul>
              </div>
             </td>
           </tr>
      </table><br/>
      <table class="cardFormContainer" cellspacing='0' cellpadding='0'>
          <tr>
             <td class="cardFormElementTitle">Where incident occurred</td>
          </tr>
           <tr>
            <td colspan="2" class="cardFormElementContent">
              <div  class="cardInlay">
               <ul>
            <li class="cardListElement">
             <table class="locationOccurred">
              <tr>
                <td align="right">
                  <input id="sitePath" type="Text" style="overflow:auto" ng-model="model.sitePath" />
                </td>
              </tr>
             </table>
            </li>
           </ul>
              </div>
             </td>
           </tr>
      </table><br/>
      <table class="cardFormContainer" cellspacing='0' cellpadding='0'>
          <tr>
             <td class="cardFormElementTitle">Specific location</td>
          </tr>
           <tr>
            <td colspan="2" class="cardFormElementContent">
              <div  class="cardInlay">
               <ul>
            <li class="cardListElement">
             <table>
              <tr>
                <td align="right">
                  <input type="Text" ng-model="model.location" />
                </td>
              </tr>
             </table>
            </li>
           </ul>
              </div>
             </td>
           </tr>
      </table><br/>
    </div>

    <div id="step3" ng-if="currStep == 3" align="center">
       <div >
      <table class="cardFormContainer" cellspacing='0' cellpadding='0' >
          <tr>
             <td class="cardFormElementTitle">Risk discipline (Nature of the impact)</td>
          </tr>
           <tr>
            <td colspan="2" class="cardFormElementContent">
              <div  id="risk-scroll"  class="cardInlay" style="overflow:auto;height:200px">
               <ul>
                <li class="cardListElement"> 
                 <table>
                  <tr ng-repeat="view in model.views">
                    <td align="right">
                      <input type="checkbox" onChange="_incidentCapture.reloadSubCat()" ng-model="view.checked" value="1"/> {{view.SourceList}}
                      <br>
                    </td>
                  </tr>
                 </table>
                </li>
               </ul>
              </div>
             </td>
           </tr>
      </table>
    </div>
    <br />

 <div >
      <table class="cardFormContainer" cellspacing='0' cellpadding='0' >
          <tr>
             <td class="cardFormElementTitle">Incident category / sub category</td>
          </tr>
           <tr>
            <td colspan="2" class="cardFormElementContent">
              <div  id="risk-scroll2"  class="cardInlay" style="overflow:auto;height:200px">
               <ul>
            <li class="cardListElement">
             <div id="catList" class="gui-extra">
              <table>
              <tr ng-repeat="view in model.views">
                <td align="right">
                  <div ng-show="view.checked && view.categories.length > 0">

                    
                      <div ng-include="'partialCat'" ng-init="cats = view.categories"></div>
                    
                       <!--  <input type="checkbox" ng-click="" ng-model="view.checked" value="1"/> {{view.categories[0].SourceList}}
                        <br> -->
                    <script type="text/ng-template" id="partialCat">
                      <ul>
                        <li ng-repeat="cat in cats" SourceListID={{cat.SourceListID}}> <input type="checkbox" ng-if="cat.children.length == 0" ng-model="cat.checked" />{{cat.SourceList}} <x ng-if="cat.children.length > 0">&#xf068;</x>
                        <br ng-if="cat.children.length == 0">
                            <div ng-if="cat.children.length > 0" ng-init="cats = cat.children" ng-include="'partialCat'" style="padding: 5px;"></div>
                        </li>
                      </ul>
                    </script>
                  </div>
                </td>
              </tr>
             </table>
             </div>
            </li>
           </ul>
              </div>
             </td>
           </tr>
      </table>
    </div>
    </div>
    <div id="step4" ng-if="currStep == 4" align="center">
<table class="cardFormContainer" cellspacing='0' cellpadding='0' >
          <tr>
             <td class="cardFormElementTitle">Immediate action taken with reason for action taken</td>
          </tr>
           <tr>
            <td colspan="2" class="cardFormElementContent">
              <div  class="cardInlay" >
               <ul>
                <li class="cardListElement"> 
                 <textarea name="Text1" cols="40" rows="5" ng-model="model.action"></textarea>
                </li>
               </ul>
              </div>
             </td>
           </tr>
      </table>
    <br />
    <div >
      <table class="cardFormContainer" cellspacing='0' cellpadding='0' >
          <tr>
             <td class="cardFormElementTitle">External party involved?</td>
          </tr>
           <tr>
            <td colspan="2" class="cardFormElementContent">
              <div   class="cardInlay" style="overflow:auto;height:150px:" align="center">
                <center>
                  Yes  <input type="range" name="points" min="0" max="1" style="width:100px" ng-model="model.external" >  No
                </center>
              </div>
             </td>
           </tr>
      </table>
    </div>
    <br />

        <div ng-show="model.external == 0">
          <table class="cardFormContainer" cellspacing='0' cellpadding='0' >
              <tr>
                 <td class="cardFormElementTitle">External party</td>
              </tr>
               <tr>
                <td colspan="2" class="cardFormElementContent">
                  <div  id="risk-scroll"  class="cardInlay" >
                   <ul>
                    <li class="cardListElement"> 
                     <table>
                      <tr ng-repeat="view in model.externalList">
                        <td align="right">
                          <input type="checkbox" ng-model="view.checked" value="1"/> {{view.SourceList}}
                          <br>
                        </td>
                      </tr>
                     </table>
                    </li>
                   </ul>
                  </div>
                 </td>
               </tr>
          </table>
        </div>
    </div>
    </content>
    <cbl>
      <x ng-show="currStep > 1" class="gui-extra" onClick="_incidentCapture.prevStep()">&#xf053; Back</x>
    </cbl>
    <cbr >
      <x class="gui-extra" style="padding-right:5px ;" onClick="_incidentCapture.save()">&#xf0ed; Save</x>
      <x ng-show="currStep < 4" class="gui-extra" onClick="_incidentCapture.nextStep()">Next &#xf054;</x>
    </cbr>

</face>


</card>

 

