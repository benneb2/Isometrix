<card id="incidentCapture" fill="true">
  <face id="incidentCaptureStep1" settings="default:true;" controller="_incidentCapture.Ctrl">
    <ctl>Adding an Incident record - {{currStep}}/4</ctl>
    <ctr></ctr>
    <content id="frontContent">
      <center>
      <div id="step1" ng-if="currStep == 1" >
      <table class="cardFormContainer" cellspacing='0' cellpadding='0'>
          <tr>
             <td class="cardFormElementTitle"  >Incident description <x style="color:red">*</x></td>
          </tr>
          <tr>
            <td>
              <input type="Text" ng-model="model.description" placeholder="Insert incident description here"/>
            </td>
          </tr>
      </table><br/>
      <table class="cardFormContainer" cellspacing='0' cellpadding='0'>
          <tr>
             <td class="cardFormElementTitle" >Incident status <x style="color:red">*</x></td>
          </tr>
           <tr>
            <td >
              <select ng-model="model.incidentStatusSelect" ng-options="status.SourceList for status in model.incidentStatus" ></select>
            </td>
           </tr>
      </table><br/>
      <table class="cardFormContainer" cellspacing='0' cellpadding='0'>
          <tr>
             <td class="cardFormElementTitle">Date incident occurred <x style="color:red">*</x></td>
          </tr>
           <tr>
            <td >
		           <input type="date" ng-model="model.date"  />
             </td>
           </tr>
      </table><br/>
      <table class="cardFormContainer" cellspacing='0' cellpadding='0'>
          <tr>
             <td class="cardFormElementTitle">Time incident occurred <x style="color:red">*</x> </td>
          </tr>
           <tr>
            <td >
              <input type="time" ng-model="model.time" />
            </td> 
           </tr>
      </table><br/>

    </div>

    <div id="step2" ng-if="currStep == 2" align="center">
      <div id="popDiv" class="ontop" ng-init="_click=false;" align="left">
        <div id="popup" style="border: 1px solid #bbb">
          <div style="height: 15%; border-bottom: 1px solid #bbb;color:#000 ;margin: 0; padding: 0;" allign="center">
            Location
          </div>
        <div id="level-scroll" style="height: 60% ;padding-top: 5px; padding-bottom: 5px; overflow:auto">
          <div id="expList" class="gui-extra">
            <div ng-include="'partialMenu'" ng-init="sites = model.sites"></div>
          </div>
        </div>
         <div style=" position: absolute;bottom: 0; height:15%;width:100%; background: rgba(240, 240, 240, 1) !important" >
           <button style="border: 1px solid #000;border-radius: 1px;width: 100%; height: 100%; float: right; background: rgb(200,200,200);" type="button" onClick="_incidentCapture.hide('popDiv')" >Cancel</button>
         </div>
      </div>
    </div>
    <script type="text/ng-template" id="partialMenu">
            <ul>
              <li ng-repeat="site in sites" siteId={{site.SiteID}}> {{site.Site}} <x ng-if="site.children.length > 0" style="font-size:25px">&#xf067;</x>
                  <div ng-if="site.children.length > 0" ng-init="sites = site.children" ng-include="'partialMenu'"></div>
              </li>
            </ul>
          </script>


      <table class="cardFormContainer" cellspacing='0' cellpadding='0'>
          <tr>
             <td class="cardFormElementTitle">Person Reporting <x style="color:red">*</x></td>
          </tr>
           <tr>
            <td>
              <input type="Text" ng-model="model.person" placeholder="Please insert a value"/>
            </td>
           </tr>
      </table><br/>
      <table class="cardFormContainer" cellspacing='0' cellpadding='0'>
          <tr>
             <td class="cardFormElementTitle">Incident reported to <x style="color:red">*</x></td>
          </tr>
           <tr>
            <td >
             <select ng-model="model.usersSelect" ng-options="user.SourceList for user in model.users" placeholder="Please select a value"></select>
            </td>
           </tr>
      </table><br/>
      <table class="cardFormContainer locationOccurred" cellspacing='0' cellpadding='0'>
          <tr>
             <td class="cardFormElementTitle">Where incident occurred <x style="color:red">*</x></td>
          </tr>
           <tr>
            <td >
              <input id="sitePath" type="Text" style="overflow:auto" ng-model="model.sitePath" placeholder="Please select a value"/>
            </td>
           </tr>
      </table><br/>
      <table class="cardFormContainer" cellspacing='0' cellpadding='0'>
          <tr>
             <td class="cardFormElementTitle">Specific location <x style="color:red">*</x></td>
          </tr>
           <tr>
            <td>
              <input type="Text" ng-model="model.location" placeholder="Please insert a value"/>
             </td>
           </tr>
      </table><br/>
    </div>

    <div id="step3" ng-if="currStep == 3" align="center">
       <div >
      <table class="cardFormContainer" cellspacing='0' cellpadding='0' >
          <tr>
             <td class="cardFormElementTitle">Risk discipline (Nature of the impact) <x style="color:red">*</x></td>
          </tr>
           <tr>
            <td > 
              <div  id="risk-scroll" style="overflow:auto;height:200px;border:solid;border-width:2px;border-color:black;">
               <ul>
                <li class="cardListElement"> 
                 <table>
                  <tr ng-repeat="view in model.views">
                    <td >
                      <input type="checkbox" onChange="_incidentCapture.reloadSubCat()" ng-model="view.checked" value="1"/> {{view.SourceList}}
                      <br>
                    </td>
                  </tr>
                 </table>
                </li>
               </ul>
              </div>
             </td>
           </tr>
      </table>
    </div>
    <br />

 <div >
      <table class="cardFormContainer" cellspacing='0' cellpadding='0' >
          <tr>
             <td class="cardFormElementTitle">Incident category / sub category <x style="color:red">*</x></td>
          </tr>
           <tr>
            <td >
              <div  id="risk-scroll2"   style="overflow:auto;height:200px;border:solid;border-width:2px;border-color:black;">
             <ul>
            <li class="cardListElement">
             <div id="catList" >
              <table class="gui-extra">
              <tr ng-repeat="view in model.views" ng-show="view.checked && view.categories.length > 0">
                <td >
                  <div>

                    
                      <div ng-include="'partialCat'" ng-init="cats = view.categories"></div>

                    <script type="text/ng-template" id="partialCat">
                      <ul>
                        <li ng-repeat="cat in cats" SourceListID={{cat.SourceListID}}> <input type="checkbox" ng-if="cat.children.length == 0" ng-model="cat.checked" />{{cat.SourceList}}  <x ng-if="cat.children.length > 0" style="font-size: 25px;">&#xf068;</x>
                        <br ng-if="cat.children.length == 0">
                            <div ng-if="cat.children.length > 0" ng-init="cats = cat.children" ng-include="'partialCat'" style="padding: 10px;"></div>
                        </li>
                      </ul>
                    </script>

                  </div>
                </td>
              </tr>
             </table>
             </div>
            </li>
           </ul>
              </div>
             </td>
           </tr>
      </table>
    </div>
    </div>
    <div id="step4" ng-if="currStep == 4" align="center">
<table class="cardFormContainer" cellspacing='0' cellpadding='0' >
          <tr>
             <td class="cardFormElementTitle">Immediate action taken with reason for action taken <x style="color:red">*</x></td>
          </tr>
           <tr>
            <td >
                 <textarea name="Text1" cols="40" rows="4"  ng-model="model.action" placeholder="Please insert a value"></textarea>
             </td>
           </tr>
      </table>
    <div >
      <table class="cardFormContainer" cellspacing='0' cellpadding='0' >
          <tr>
             <td class="cardFormElementTitle">External party involved? <x style="color:red">*</x></td>
          </tr>
           <tr>
            <td style="color:black;" >
                  Yes  <input type="range" name="points" min="0" max="1" style="width:100px" ng-model="model.external" onChange="_incidentCapture.reloadExParty()">  No
             </td>
           </tr>
      </table>
    </div> 
        <div ng-show="model.external == 0">
          <table class="cardFormContainer" cellspacing='0' cellpadding='0' >
              <tr>
                 <td class="cardFormElementTitle">External party <x style="color:red">*</x></td>
              </tr>
               <tr>
                <td >
                  <div id="exParty-scroll" style="overflow:auto;height:200px;border:solid;border-width:2px;border-color:black;">
                   <ul>
                    <li class="cardListElement"> 
                     <table>
                      <tr ng-repeat="view in model.externalList">
                        <td>
                          <input type="checkbox" ng-model="view.checked" value="1" /> {{view.SourceList}}
                          <br>
                        </td>
                      </tr>
                     </table>
                    </li>
                   </ul>
                  </div>
                 </td>
               </tr>
          </table>
        </div>
    </div>
    </center>
    </content>
    <cbl>
      <x ng-show="currStep > 1" class="gui-extra" onClick="_incidentCapture.prevStep()">&#xf053; Back</x>
    </cbl>
    <cbr >
      <x class="gui-extra" style="padding-right:5px ;" onClick="_incidentCapture.save()">&#xf0ed; Save</x>
      <x ng-show="currStep < 4" class="gui-extra" onClick="_incidentCapture.nextStep()">Next &#xf054;</x>
    </cbr>

</face>


</card>

 

